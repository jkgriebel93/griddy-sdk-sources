name: Generate and Publish SDKs with Speakeasy

on:
  push:
    branches:
      - main
      - master
    paths:
      - 'openapi/nfl-com-api.yaml'
  workflow_dispatch:

jobs:
  notify-sdk-repos:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Python SDK Regeneration
        run: |
          curl -X POST \
            -H "Accept: application/vnd.github.v3+json" \
            -H "Authorization: token ${{ secrets.SDK_DEPLOY_TOKEN }}" \
            https://api.github.com/repos/jkgriebel93/griddy-nfl-python/dispatches \
            -d '{"event_type":"spec-updated"}'
